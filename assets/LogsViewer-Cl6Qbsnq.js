const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/json-crypto-BuGX2dKY.js","assets/react-BRAeUO4q.js"])))=>i.map(i=>d[i]);
import{u as Q,_ as Z}from"./index-DE3gYn8O.js";import{j as e,c as H,I as J,d as X,A as O,P as S,T as R}from"./bootstrap-CamtS1oI.js";import{r as c,u as ee}from"./react-router-_vPkLSjC.js";import{H as ae,F as te}from"./Header-uQ0qe_Gn.js";import"./react-BRAeUO4q.js";function b(t){if(navigator.clipboard&&navigator.clipboard.writeText)return navigator.clipboard.writeText(t).catch(x=>(console.warn("Copy to clipboard failed.",x),prompt("Copy to clipboard: Ctrl+C, Enter",t)));if(window.clipboardData&&window.clipboardData.setData)return window.clipboardData.setData("Text",t);if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var l=document.createElement("textarea");l.textContent=t,l.style.position="fixed",document.body.appendChild(l),l.select();try{return document.execCommand("copy")}catch(x){return console.warn("Copy to clipboard failed.",x),prompt("Copy to clipboard: Ctrl+C, Enter",t)}finally{document.body.removeChild(l)}}}function Y(t){return t.replace(/([A-Za-zÀ-ÖØ-öø-ÿ]+(?:['’][A-Za-zÀ-ÖØ-öø-ÿ]+)?)/g,l=>/^[A-ZÀ-ÖØ-Þ]+$/.test(l)?l.charAt(0).toUpperCase()+l.slice(1).toLowerCase():l.charAt(0).toUpperCase()+l.slice(1))}const se="_nikRow_1mkjo_1",ne="_paginationScroll_1mkjo_5",ie="_logTimestamp_1mkjo_22",re="_sectionTitle_1mkjo_26",le="_accordionHeader_1mkjo_31",de="_container_1mkjo_68",ce="_accordionItem_1mkjo_89",oe="_accordionBody_1mkjo_96",me="_table_1mkjo_100",he="_textSuccess_1mkjo_109",xe="_textInvalid_1mkjo_113",pe="_textError_1mkjo_117",ue="_collapseAllBtn_1mkjo_133",h={nikRow:se,paginationScroll:ne,logTimestamp:ie,sectionTitle:re,accordionHeader:le,container:de,accordionItem:ce,accordionBody:oe,table:me,textSuccess:he,textInvalid:xe,textError:pe,collapseAllBtn:ue};function je({log:t,idx:l}){var I,_,j,L,d,u,o,f,E,k,C,P,y,F,w,B,K,W,$,M,D,g,p,v,a,i,r;typeof t.message=="string"&&t.message.toLowerCase().includes("success");let x="";return((I=t.data)==null?void 0:I.status)==="invalid"?x=h.textInvalid:((_=t.data)==null?void 0:_.status)==="success"?x=h.textSuccess:x=h.textError,e.jsxs(O.Item,{eventKey:String(l),className:h.accordionItem,children:[e.jsx(O.Header,{className:h.accordionHeader,children:e.jsxs("span",{className:"d-block w-100",children:[e.jsx("span",{className:"fw-bold ".concat(x),children:((j=t.data)==null?void 0:j.nik)||""})," - ",(()=>{var s;const n=Y(((s=t.data)==null?void 0:s.nama)||"");if(typeof window<"u"){if(window.innerWidth<=350&&n.length>12)return n.slice(0,12).trim()+"…";if(window.innerWidth<=400&&n.length>15)return n.slice(0,15).trim()+"…";if(window.innerWidth<=600&&n.length>19)return n.slice(0,19).trim()+"…"}return n})()]})}),e.jsxs(O.Body,{className:h.accordionBody,children:[e.jsxs("div",{className:"d-flex align-items-center mb-2 ".concat(h.nikRow),children:[e.jsx("span",{className:"fw-bold me-2",children:"NIK:"}),e.jsx("span",{children:((L=t.data)==null?void 0:L.nik)||""}),((d=t.data)==null?void 0:d.nik)&&e.jsx("button",{className:"btn btn-sm btn-copy",title:"Copy NIK",onClick:()=>{b(t.data.nik)},children:e.jsx("i",{className:"fa fa-copy","aria-hidden":"true"})})]}),e.jsxs("div",{className:"".concat(h.logTimestamp," mb-2"),children:["Timestamp: ",t.timestamp||""]}),e.jsx("div",{className:"".concat(h.logMessage," mb-2 ").concat(x),children:t.message||((u=t.data)==null?void 0:u.message)||""}),e.jsx("span",{className:h.sectionTitle,children:"Basic Data"}),e.jsx(R,{bordered:!0,striped:!0,className:"mb-3 ".concat(h.table),children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:"Tanggal Input"}),e.jsxs("td",{children:[((o=t.data)==null?void 0:o.tanggal)||"",((f=t.data)==null?void 0:f.tanggal)&&e.jsx("button",{className:"btn btn-sm btn-copy",title:"Copy Tanggal",onClick:()=>b(t.data.tanggal),children:e.jsx("i",{className:"fa fa-copy","aria-hidden":"true"})})]})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Nama"}),e.jsxs("td",{children:[Y(((E=t.data)==null?void 0:E.nama)||""),((k=t.data)==null?void 0:k.nama)&&e.jsx("button",{className:"btn btn-sm btn-copy",title:"Copy Nama",onClick:()=>b(t.data.nama),children:e.jsx("i",{className:"fa fa-copy","aria-hidden":"true"})})]})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Tanggal Lahir"}),e.jsxs("td",{children:[((C=t.data)==null?void 0:C.tgl_lahir)||"",((P=t.data)==null?void 0:P.tgl_lahir)&&e.jsx("button",{className:"btn btn-sm btn-copy",title:"Copy Tgl Lahir",onClick:()=>b(t.data.tgl_lahir),children:e.jsx("i",{className:"fa fa-copy","aria-hidden":"true"})})]})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Alamat"}),e.jsxs("td",{children:[((y=t.data)==null?void 0:y.alamat)||"",((F=t.data)==null?void 0:F.alamat)&&e.jsx("button",{className:"btn btn-sm btn-copy",title:"Copy Alamat",onClick:()=>b(t.data.alamat),children:e.jsx("i",{className:"fa fa-copy","aria-hidden":"true"})})]})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"BB"}),e.jsxs("td",{children:[((w=t.data)==null?void 0:w.bb)||"",((B=t.data)==null?void 0:B.bb)&&e.jsx("button",{className:"btn btn-sm btn-copy",title:"Copy BB",onClick:()=>b(t.data.bb),children:e.jsx("i",{className:"fa fa-copy","aria-hidden":"true"})})]})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"TB"}),e.jsxs("td",{children:[((K=t.data)==null?void 0:K.tb)||"",((W=t.data)==null?void 0:W.tb)&&e.jsx("button",{className:"btn btn-sm btn-copy",title:"Copy TB",onClick:()=>b(t.data.tb),children:e.jsx("i",{className:"fa fa-copy","aria-hidden":"true"})})]})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Petugas"}),e.jsx("td",{children:(($=t.data)==null?void 0:$.petugas)||""})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Status"}),e.jsx("td",{children:((M=t.data)==null?void 0:M.status)||""})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Gender"}),e.jsx("td",{children:((D=t.data)==null?void 0:D.gender)||""})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Umur"}),e.jsx("td",{children:((g=t.data)==null?void 0:g.age)!==void 0&&((p=t.data)==null?void 0:p.age)!==null?"".concat(t.data.age," Tahun"):""})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Pekerjaan"}),e.jsxs("td",{children:[((v=t.data)==null?void 0:v.pekerjaan)||"",((a=t.data)==null?void 0:a.pekerjaan)&&e.jsx("button",{className:"btn-copy",title:"Copy Pekerjaan",onClick:()=>b(t.data.pekerjaan),children:e.jsx("i",{className:"fa fa-copy","aria-hidden":"true"})})]})]})]})}),((i=t.data)==null?void 0:i.parsed_nik)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"section-title",children:"Parsed NIK"}),e.jsx(R,{bordered:!0,hover:!0,className:"mb-3 parsed-nik-table",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:"Status"}),e.jsx("td",{children:t.data.parsed_nik.status||""})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Message"}),e.jsx("td",{children:t.data.parsed_nik.message||""})]}),t.data.parsed_nik.data&&e.jsxs(e.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("th",{children:"NIK"}),e.jsx("td",{children:t.data.parsed_nik.data.nik||""})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Kelamin"}),e.jsx("td",{children:(t.data.parsed_nik.data.kelamin||"")==="P"?"Perempuan":"Laki-laki"})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Lahir"}),e.jsx("td",{children:t.data.parsed_nik.data.lahir||""})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Provinsi"}),e.jsx("td",{children:t.data.parsed_nik.data.provinsi||""})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Kota/Kab"}),e.jsx("td",{children:t.data.parsed_nik.data.kotakab||""})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Kecamatan"}),e.jsx("td",{children:t.data.parsed_nik.data.namaKec||""})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Uniqcode"}),e.jsx("td",{children:t.data.parsed_nik.data.uniqcode||""})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Original Lahir"}),e.jsx("td",{children:t.data.parsed_nik.data.originalLahir||""})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Kelurahan"}),e.jsx("td",{children:Array.isArray(t.data.parsed_nik.data.kelurahan)?e.jsx("ul",{className:"list-group list-group-flush",children:t.data.parsed_nik.data.kelurahan.map((n,s)=>n&&typeof n=="object"&&n.name?e.jsxs("li",{className:"list-group-item",children:[n.name," ",e.jsxs("span",{className:"text-muted",children:["(ID: ",n.id,", District: ",n.district_id,")"]})]},s):null)}):""})]})]})]})})]}),((r=t.data)==null?void 0:r.formValues)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"section-title",children:"Form Values"}),e.jsxs(R,{bordered:!0,size:"sm",className:"mb-3",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Label"}),e.jsx("th",{children:"Value"})]})}),e.jsx("tbody",{children:t.data.formValues.map((n,s)=>e.jsxs("tr",{children:[e.jsx("td",{children:n.label||""}),e.jsx("td",{children:n.value||"<empty>"})]},s))})]})]})]})]})}function ve({pageTitle:t="Log Viewer"}){const[l,x]=c.useState([]),[I,_]=c.useState(!0),[j,L]=c.useState(""),[d,u]=c.useState({status:"",gender:"",provinsi:"",kotakab:"",kecamatan:""}),[o,f]=c.useState(1),[E,k]=c.useState([]),[C,P]=c.useState(!1),y=20,F=ee(),{theme:w}=Q();c.useEffect(()=>{let a=!0;return _(!0),Z(async()=>{const{decryptJson:i}=await import("./json-crypto-BuGX2dKY.js");return{decryptJson:i}},__vite__mapDeps([0,1])).then(({decryptJson:i})=>{Z(async()=>{const{default:r}=await import("./axios-0LJo1Vxi.js");return{default:r}},[]).then(({default:r})=>{r.get("/browser-automation/assets/data/logs.json",{responseType:"text"}).then(n=>{let s=[];const m="json$ecret";try{s=i(n.data,m)}catch(N){console.error("Failed to decrypt logs:",N),s=[]}a&&x(s),_(!1)}).catch(n=>{console.error("Failed to fetch logs:",n),a&&x([]),_(!1)})})}),()=>{a=!1}},[]);const B=c.useMemo(()=>l.filter(a=>a.data&&a.data.status==="success").length,[l]),K=c.useMemo(()=>l.filter(a=>a.data&&(a.data.status==="failed"||a.data.status==="error")).length,[l]),W=c.useMemo(()=>l.filter(a=>a.data&&a.data.status==="invalid").length,[l]),$=c.useMemo(()=>{const a=new Set;return l.forEach(i=>{var n,s,m;const r=(m=(s=(n=i.data)==null?void 0:n.parsed_nik)==null?void 0:s.data)==null?void 0:m.provinsi;r&&a.add(r)}),Array.from(a).sort()},[l]),M=c.useMemo(()=>{const a=new Set;return l.forEach(i=>{var n,s,m;const r=(m=(s=(n=i.data)==null?void 0:n.parsed_nik)==null?void 0:s.data)==null?void 0:m.kotakab;r&&a.add(r)}),Array.from(a).sort()},[l]),D=c.useMemo(()=>{const a=new Set;return l.forEach(i=>{var n,s,m;const r=(m=(s=(n=i.data)==null?void 0:n.parsed_nik)==null?void 0:s.data)==null?void 0:m.namaKec;r&&a.add(r)}),Array.from(a).sort()},[l]),g=c.useMemo(()=>{let a=l;if(j.trim()){const i=j.trim().toLowerCase();a=a.filter(r=>{var s,m,N,T,A,V,z,U,q;return[(s=r.data)==null?void 0:s.nik,(m=r.data)==null?void 0:m.nama,r.message,(N=r.data)==null?void 0:N.tanggal,(T=r.data)==null?void 0:T.alamat,(A=r.data)==null?void 0:A.petugas,(V=r.data)==null?void 0:V.status,(z=r.data)==null?void 0:z.gender,(U=r.data)==null?void 0:U.age,(q=r.data)==null?void 0:q.pekerjaan].some(G=>typeof G=="string"&&G.toLowerCase().includes(i))})}return d.status&&(a=a.filter(i=>{var r;return((r=i.data)==null?void 0:r.status)===d.status})),d.gender&&(a=a.filter(i=>{var m,N,T,A;const r=(((m=i.data)==null?void 0:m.gender)||"").toUpperCase(),n=(((A=(T=(N=i.data)==null?void 0:N.parsed_nik)==null?void 0:T.data)==null?void 0:A.kelamin)||"").toUpperCase(),s=d.gender.toUpperCase();return r===s||n===s})),d.provinsi&&(a=a.filter(i=>{var r,n,s;return((s=(n=(r=i.data)==null?void 0:r.parsed_nik)==null?void 0:n.data)==null?void 0:s.provinsi)===d.provinsi})),d.kotakab&&(a=a.filter(i=>{var r,n,s;return((s=(n=(r=i.data)==null?void 0:r.parsed_nik)==null?void 0:n.data)==null?void 0:s.kotakab)===d.kotakab})),d.kecamatan&&(a=a.filter(i=>{var r,n,s;return((s=(n=(r=i.data)==null?void 0:r.parsed_nik)==null?void 0:n.data)==null?void 0:s.namaKec)===d.kecamatan})),a},[l,j,d]),p=Math.ceil(g.length/y),v=g.slice((o-1)*y,o*y);return c.useEffect(()=>{console.log("filteredLogs.length:",g.length,"totalPages:",p,"currentPage:",o,"paginatedLogs.length:",v.length),o>1&&v.length===0&&f(1)},[g.length,p,o,v.length]),c.useEffect(()=>{f(1),k([])},[j,d]),c.useEffect(()=>{k([])},[o]),I?e.jsx("div",{className:"text-center my-5",children:"Loading logs..."}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{}),e.jsx("div",{className:"m-0 m-md-5",children:e.jsxs("div",{id:"logs-viewer",className:"container mx-auto py-4 bg-body-tertiary ".concat(h.container),"data-bs-theme":w,children:[e.jsxs("button",{type:"button",className:"btn ".concat(w==="dark"?"btn-outline-light":"btn-outline-dark"," mb-3"),onClick:()=>F("/"),children:[e.jsx("i",{className:"fa fa-arrow-left me-2"})," Back"]}),e.jsx("h1",{className:"my-4 text-body text-center",children:t}),e.jsxs("div",{className:"mb-4 d-flex flex-wrap justify-content-center gap-2",children:[e.jsxs(H,{bg:"success",className:"px-2 py-1 fw-normal text-center",style:{fontSize:"0.92em",minWidth:70,maxWidth:100},children:[e.jsx("i",{className:"fa-solid fa-circle-check me-1","aria-hidden":"true"})," ",B]}),e.jsxs(H,{bg:"danger",className:"px-2 py-1 fw-normal text-center",style:{fontSize:"0.92em",minWidth:70,maxWidth:100},children:[e.jsx("i",{className:"fa-solid fa-circle-exclamation me-1","aria-hidden":"true"})," ",W]}),e.jsxs(H,{bg:"secondary",className:"px-2 py-1 fw-normal text-center",style:{fontSize:"0.92em",minWidth:70,maxWidth:100},children:[e.jsx("i",{className:"fa-solid fa-circle-xmark me-1","aria-hidden":"true"})," ",K]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("button",{type:"button",className:"btn btn-sm ".concat(w==="dark"?"btn-outline-light":"btn-outline-dark"," mb-2"),style:{width:"100%"},"aria-expanded":C,onClick:()=>P(a=>!a),children:[e.jsx("i",{className:"fa ".concat(C?"fa-chevron-up":"fa-chevron-down")})," Filter Options"]}),C&&e.jsxs("div",{className:"row g-2",children:[e.jsx("div",{className:"col-12 col-sm-6",children:e.jsxs("div",{className:"d-grid",style:{gridTemplateColumns:"110px 1fr",alignItems:"center"},children:[e.jsx("label",{className:"form-label mb-0 text-end pe-2",htmlFor:"filter-status",style:{whiteSpace:"nowrap"},children:"Status:"}),e.jsxs("select",{id:"filter-status",className:"form-select form-select-sm",value:d.status,onChange:a=>u(i=>({...i,status:a.target.value})),children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"success",children:"Success"}),e.jsx("option",{value:"invalid",children:"Invalid"}),e.jsx("option",{value:"error",children:"Error"})]})]})}),e.jsx("div",{className:"col-12 col-sm-6",children:e.jsxs("div",{className:"d-grid",style:{gridTemplateColumns:"110px 1fr",alignItems:"center"},children:[e.jsx("label",{className:"form-label mb-0 text-end pe-2",htmlFor:"filter-gender",style:{whiteSpace:"nowrap"},children:"Gender:"}),e.jsxs("select",{id:"filter-gender",className:"form-select form-select-sm",value:d.gender,onChange:a=>u(i=>({...i,gender:a.target.value})),children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"L",children:"L"}),e.jsx("option",{value:"P",children:"P"})]})]})}),e.jsx("div",{className:"col-12 col-sm-6",children:e.jsxs("div",{className:"d-grid",style:{gridTemplateColumns:"110px 1fr",alignItems:"center"},children:[e.jsx("label",{className:"form-label mb-0 text-end pe-2",htmlFor:"filter-provinsi",style:{whiteSpace:"nowrap"},children:"Provinsi:"}),e.jsxs("select",{id:"filter-provinsi",className:"form-select form-select-sm",value:d.provinsi,onChange:a=>u(i=>({...i,provinsi:a.target.value})),children:[e.jsx("option",{value:"",children:"All"}),$.map((a,i)=>e.jsx("option",{value:a,children:a},i))]})]})}),e.jsx("div",{className:"col-12 col-sm-6",children:e.jsxs("div",{className:"d-grid",style:{gridTemplateColumns:"110px 1fr",alignItems:"center"},children:[e.jsx("label",{className:"form-label mb-0 text-end pe-2",htmlFor:"filter-kotakab",style:{whiteSpace:"nowrap"},children:"Kota/Kab:"}),e.jsxs("select",{id:"filter-kotakab",className:"form-select form-select-sm",value:d.kotakab,onChange:a=>u(i=>({...i,kotakab:a.target.value})),children:[e.jsx("option",{value:"",children:"All"}),M.map((a,i)=>e.jsx("option",{value:a,children:a},i))]})]})}),e.jsx("div",{className:"col-12 col-sm-6",children:e.jsxs("div",{className:"d-grid",style:{gridTemplateColumns:"110px 1fr",alignItems:"center"},children:[e.jsx("label",{className:"form-label mb-0 text-end pe-2",htmlFor:"filter-kecamatan",style:{whiteSpace:"nowrap"},children:"Kecamatan:"}),e.jsxs("select",{id:"filter-kecamatan",className:"form-select form-select-sm",value:d.kecamatan,onChange:a=>u(i=>({...i,kecamatan:a.target.value})),children:[e.jsx("option",{value:"",children:"All"}),D.map((a,i)=>e.jsx("option",{value:a,children:a},i))]})]})}),e.jsx("div",{className:"col-12 col-sm-6",children:e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-danger w-100",title:"Clear Filters",onClick:()=>u({status:"",gender:"",provinsi:"",kotakab:"",kecamatan:""}),children:[e.jsx("i",{className:"fa fa-times"})," Clear Filters"]})})]})]}),e.jsxs(J,{className:"mb-3",id:"log-search-group",children:[e.jsx(J.Text,{children:e.jsx("i",{className:"fa-solid fa-magnifying-glass"})}),e.jsx(X,{type:"text",placeholder:"Search logs...",autoComplete:"off",value:j,onChange:a=>L(a.target.value)}),e.jsxs("button",{type:"button",className:h.collapseAllBtn+" ms-2",title:"Collapse All",onClick:()=>k([]),children:[e.jsx("i",{className:"fa-solid fa-compress"})," ",e.jsx("span",{className:"sr-only",children:"Collapse All"})]})]}),e.jsx(O,{style:{maxHeight:"70vh",overflowY:"auto"},activeKey:E,onSelect:a=>{a&&k(i=>{const r=String(a);let n=Array.isArray(i)?i:[];return n.includes(r)?n.filter(s=>s!==r):[...n,r]})},children:v.map((a,i)=>e.jsx(je,{log:a,idx:String(i+1+(o-1)*y)},i))}),e.jsx("div",{className:"my-3 d-flex justify-content-center ".concat(h.paginationScroll),children:e.jsxs(S,{size:"sm",children:[e.jsxs(S.Prev,{disabled:o===1,onClick:()=>f(a=>Math.max(1,a-1)),children:[e.jsx("i",{className:"fa fa-angle-left","aria-hidden":"true"}),e.jsx("span",{className:"visually-hidden",children:"Previous"})]}),(()=>{const a=[];let r=!1,n=!1;for(let s=1;s<=p;s++)s===1||s===p||s>=o-2&&s<=o+2?a.push(e.jsx(S.Item,{active:s===o,onClick:()=>f(s),children:s},s)):s<o-2&&!r&&s!==1?(a.push(e.jsx(S.Ellipsis,{disabled:!0},"left-ellipsis")),r=!0):s>o+2&&!n&&s!==p&&(a.push(e.jsx(S.Ellipsis,{disabled:!0},"right-ellipsis")),n=!0);return a})(),e.jsxs(S.Next,{disabled:o===p,onClick:()=>f(a=>Math.min(p,a+1)),children:[e.jsx("i",{className:"fa fa-angle-right","aria-hidden":"true"}),e.jsx("span",{className:"visually-hidden",children:"Next"})]})]})})]})}),e.jsx(te,{})]})}export{ve as default};
